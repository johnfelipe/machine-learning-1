(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a711cad"],{"7db0":function(t,i,e){"use strict";var s=e("23e7"),a=e("b727").find,o=e("44d2"),n=e("ae40"),r="find",l=!0,h=n(r);r in[]&&Array(1)[r]((function(){l=!1})),s({target:"Array",proto:!0,forced:l||!h},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),o(r)},dd11:function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("component-layout",{attrs:{component:t.component,length:t.length,loading:t.loading},on:{"update:component":function(i){t.component=i},"update:length":function(i){t.length=i},"update:loading":function(i){t.loading=i}}},[e("b-form",{staticClass:"form-toolbar-rtl",attrs:{inline:""}},[e("b-button",{attrs:{size:"badge",disabled:t.plugActionDisabled},on:{click:t.plugAction}},[e("b-icon",{staticClass:"btn-icon",attrs:{icon:"plug"}})],1),e("b-button",{attrs:{size:"badge",disabled:t.trashActionDisabled},on:{click:t.trashAction}},[e("b-icon",{staticClass:"btn-icon",attrs:{icon:"trash"}})],1),e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"dataset-view-"+t.component.index,expression:"'dataset-view-' + component.index"}],attrs:{size:"badge",disabled:t.imageActionDisabled}},[e("b-icon",{staticClass:"btn-icon",attrs:{icon:"card-image"}})],1),e("b-button",{attrs:{size:"badge"},on:{click:t.onToggleToolbar}},[e("b-icon",{attrs:{icon:t.toggleIcon}})],1)],1),e("b-collapse",{attrs:{visible:"caret-up"===t.toggleIcon}},[e("b-form",{attrs:{inline:""}},[e("div",{staticClass:"indexInput"},[e("label",[t._v("Total Layers")]),e("b-form-spinbutton",{attrs:{min:"1",max:t.indexMax,placeholder:"--",disabled:t.editActionDisabled},model:{value:t.layerSize,callback:function(i){t.layerSize=i},expression:"layerSize"}})],1),e("div",{staticClass:"indexInput"},[e("label",[t._v("Label Index")]),e("b-form-spinbutton",{attrs:{min:"-1",max:t.dataSize-1,"formatter-fn":t.indexFormatter,disabled:t.editActionDisabled},model:{value:t.indexSerie,callback:function(i){t.indexSerie=i},expression:"indexSerie"}})],1)])],1),e("div",{staticStyle:{"margin-top":"8px"}}),e("b-modal",{attrs:{id:"dataset-view-"+t.component.index,title:"Dataset View",static:!0,"hide-footer":!0,size:"lg"},on:{show:t.onShowModal}},[e("b-carousel",{ref:"dataset-view-carousel",class:"carousel-loading-"+t.loading,attrs:{interval:0,indicators:t.scatterPlot||t.perClassAccuracy||t.confusionMatrix,controls:t.seriesPlot}},[t.scatterPlot?e("b-carousel-slide",{attrs:{"img-blank":!0},scopedSlots:t._u([{key:"img",fn:function(){return[e("div",{ref:"scatterPlot"})]},proxy:!0}],null,!1,3122916720)}):t._e(),t.perClassAccuracy?e("b-carousel-slide",{attrs:{"img-blank":!0},scopedSlots:t._u([{key:"img",fn:function(){return[e("div",{ref:"perClassAccuracy"})]},proxy:!0}],null,!1,3153054725)}):t._e(),t.confusionMatrix?e("b-carousel-slide",{attrs:{"img-blank":!0},scopedSlots:t._u([{key:"img",fn:function(){return[e("div",{ref:"confusionMatrix"})]},proxy:!0}],null,!1,3258938016)}):t._e(),t.seriesPlot?e("b-carousel-slide",{attrs:{"img-blank":!0},scopedSlots:t._u([{key:"img",fn:function(){return[e("div",{ref:"draw-loading",staticClass:"text-center"},[e("div",{staticStyle:{width:"500px",height:"400px",margin:"0 auto"}},[e("div",{staticStyle:{position:"relative",top:"50%"}},[e("b-spinner",{attrs:{type:"grow"}})],1)])]),e("div",{ref:"draw",staticClass:"text-center"})]},proxy:!0}],null,!1,3504336249)}):t._e()],1),e("footer",{staticClass:"modal-footer"})],1)],1)},a=[],o=e("e04e"),n=o["a"],r=e("2877"),l=Object(r["a"])(n,s,a,!1,null,"bfd53892",null);i["default"]=l.exports},e04e:function(t,i,e){"use strict";(function(t){e("99af"),e("7db0"),e("a630"),e("d81d"),e("fb6a"),e("d3b7"),e("6062"),e("3ca3"),e("ddb0");var s=e("2909"),a=e("315f"),o=e("cc8f"),n=e("1157"),r=e.n(n),l=e("2ef0"),h=e.n(l),c=e("61cc"),u=e.n(c),d=e("9131");
/**
 * @license
 * Copyright 2020 Rodrigo Oshiro. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */i["a"]={name:"TSModelPredictor",components:{ComponentLayout:a["a"]},mixins:[o["a"]],data:function(){var t={serializable:["layerSize","indexSerie"],layerSize:0,indexSerie:-1,imagePage:0,fileChart:!1,scatterPlot:!0,perClassAccuracy:!0,confusionMatrix:!0,seriesPlot:!0,toggleIcon:"caret-up"};return this.importData(t)},mounted:function(){r()(this.$refs["dataset-view-carousel"].$el).find(".carousel-control-prev").on("click",this.onPrevPage),r()(this.$refs["dataset-view-carousel"].$el).find(".carousel-control-next").on("click",this.onNextPage)},computed:{editActionDisabled:function(){var t=0;return t|=0===this.indexMax,1===t},trashActionDisabled:function(){return this.editActionDisabled},plugActionDisabled:function(){var t=0;return t|=!0===this.loading,t|=null===this.global.model,t|=null===this.inputData||void 0===this.inputData.normalizationData,t|=this.layerSize>this.indexMax,1===t},imageActionDisabled:function(){var t=0;return t|=!1===this.fileChart,1===t},indexMax:function(){var t=0;return this.global.model&&this.global.model.layers&&(t=this.global.model.layers.length),t},dataSize:function(){var t=0;return Array.isArray(this.global.inputShape)&&this.global.inputShape.length>1&&(t=this.global.inputShape[0]),t}},watch:{loading:function(t,i){!1===t&&(delete this.$options.sockets.onerror,delete this.$options.sockets.onopen,delete this.$options.sockets.onmessage)}},methods:{onToggleToolbar:function(){"caret-up"===this.toggleIcon?this.toggleIcon="caret-down":"caret-down"===this.toggleIcon&&(this.toggleIcon="caret-up")},loadPage:function(){r()(this.$refs["draw-loading"]).show(),r()(this.$refs["draw"]).hide(),r()(this.$refs["draw"]).empty();var t=this.indexSerie,i=this.global.inputShape[0],e=this.global.outputShape[0],a=this.global.evaluation.timestamps[this.imagePage],o=Object(s["a"])(this.output[this.imagePage].slice(0,i).map((function(i){return i[t]}))).concat(this.output[this.imagePage].slice(i,i+e)),n=this.global.evaluation.timestamps[this.imagePage].slice(-e),l=Object(s["a"])(this.output[this.imagePage].slice(i+e,i+e+e)),h={name:"True Future",x:a,y:o,mode:"lines",marker:{size:12,line:{width:.5},opacity:1},type:"scatter2d"},c={name:"Model Prediction",x:n,y:l,mode:"lines",marker:{size:12,line:{width:.5},opacity:1},type:"scatter2d"},d={scene:{xaxis:{title:"X axis"},yaxis:{title:"Y axis"}}};r()(this.$refs["draw-loading"]).hide(),r()(this.$refs["draw"]).show(),u.a.newPlot(this.$refs["draw"],[h,c],d)},onShowModal:function(){this.seriesPlot&&this.loadPage()},onPrevPage:function(t){!1===this.loading&&(this.imagePage-=1,this.imagePage<0&&(this.imagePage=this.output.length-1),this.loadPage())},onNextPage:function(t){!1===this.loading&&(this.imagePage+=1,this.imagePage>this.output.length&&(this.imagePage=0),this.loadPage())},trashActionEvent:function(t){r()(this.$refs["draw"]).empty(),this.fileChart=!1,this.scatterPlot=!0,this.perClassAccuracy=!0,this.confusionMatrix=!0,this.seriesPlot=!0,void 0!==this.inputTensor&&(this.inputTensor.dispose(),delete this.inputTensor),void 0!==this.outputTensor&&(this.outputTensor.dispose(),delete this.outputTensor),this.output=null},plugActionPost:function(i){var e=this.inputData.normalizationData,s=t[i.data["type"]].from(i.data["data"]);if(void 0!==this.predictTensor&&this.predictTensor.dispose(),this.predictTensor=this.$tf.tensor(s,i.shape),e.outputUnitsNormalize){var a=e.outputMin,o=e.outputMax,n=d["tasks"].unnormalizeTensor(this.$tf,this.predictTensor,a,o),r=n.unnormal;this.predictTensor.dispose(),this.predictTensor=r}var l=this.predictTensor.arraySync(),c=this.global.inputMatrix,u=h.a.cloneDeep(this.global.inputShape);null!==this.global.evaluation?c=this.global.evaluation.inputMatrix:null===this.global.evaluation&&null!==this.global.training&&(c=this.global.training.inputMatrix),u.unshift(c.length),void 0!==this.inputTensor&&this.inputTensor.dispose(),this.inputTensor=this.$tf.tensor(c,u);var p=this.global.outputMatrix,g=h.a.cloneDeep(this.global.outputShape);if(null!==this.global.evaluation?p=this.global.evaluation.outputMatrix:null===this.global.evaluation&&null!==this.global.training&&(p=this.global.training.outputMatrix),g.unshift(p.length),"sparseCategoricalCrossentropy"===this.global.loss){for(var f=[],b=0;b<p.length;b++){for(var m=parseInt(p[b][0]),v=[],x=0;x<this.predictTensor.shape[1];x++)v.push(m===x?1:0);f.push(v)}g=[f.length,this.predictTensor.shape[1]],p=f}void 0!==this.outputTensor&&this.outputTensor.dispose(),this.outputTensor=this.$tf.tensor(p,g);var y=[],T=[];if(null!==this.global.evaluation&&this.global.evaluation.labels.length)T=this.global.evaluation.labels,y=Array.from(new Set(T));else if(null===this.global.evaluation&&null!==this.global.training&&this.global.training.labels.length)T=this.global.training.labels,y=Array.from(new Set(T));else for(var w=0;w<this.global.outputShape[0];w++)y.push(String(w));this.scatterPlot=!1,this.perClassAccuracy=!1,this.confusionMatrix=!1,this.seriesPlot=!1;var P=this.inputTensor.shape[1]*this.outputTensor.shape[1]*this.predictTensor.shape[1];if(1===P){this.scatterPlot=!0;for(var A=[],S=[],M=0;M<c.length;M++)A.push({x:c[M][0],y:p[M][0]}),S.push({x:c[M][0],y:l[M][0]});this.$tfvis.render.scatterplot(this.$refs["scatterPlot"],{values:[A,S],series:["original","predicted"]},{width:700,height:450}),this.fileChart=!0}this.classNames=y,this.indexSerie>-1?(this.fileChart=!0,this.seriesPlot=!0,this.outputTensor.dispose(),this.predictTensor.dispose()):0!==y.length&&this.outputTensor.shape[1]===this.predictTensor.shape[1]?this.$tf.tidy(function(){var t=["perClassAccuracy","confusionMatrix"];this.perClassAccuracy=!0,this.$tfvis.metrics.perClassAccuracy(this.outputTensor.argMax(-1),this.predictTensor.argMax(-1)).then(function(i){this.$tfvis.show.perClassAccuracy(this.$refs["perClassAccuracy"],i,y),this.fileChart=!0,t.pop(),0===t.length&&(this.outputTensor.dispose(),this.predictTensor.dispose())}.bind(this)),this.confusionMatrix=!0,this.$tfvis.metrics.confusionMatrix(this.outputTensor.argMax(-1),this.predictTensor.argMax(-1)).then(function(i){this.$tfvis.render.confusionMatrix(this.$refs["confusionMatrix"],{values:i,tickLabels:y},{width:700,height:450}),this.fileChart=!0,t.pop(),0===t.length&&(this.outputTensor.dispose(),this.predictTensor.dispose())}.bind(this))}.bind(this)):(this.outputTensor.dispose(),this.predictTensor.dispose());for(var $=[],k=0;k<c.length;k++){for(var C=[],D=0;D<this.inputTensor.shape[1];D++)C.push(c[k][D]);for(var z=0;z<this.outputTensor.shape[1];z++)C.push(p[k][z]);for(var E=0;E<this.predictTensor.shape[1];E++)C.push(l[k][E]);0!==T.length&&C.push(T[k]),$.push(C)}this.inputTensor.dispose(),this.output=$},plugActionNext:function(t){this.$options.sockets.onerror=function(){var i=new Worker("worker.js");i.onmessage=function(t){"onEnd"===t.data[0]&&t.error?(i.terminate(),this.plugActionEnd(t)):"onEnd"===t.data[0]?(this.plugActionPost(t.data[1]),i.terminate(),this.plugActionEnd(t)):"onError"===t.data[0]&&(console.error(t.data[1]),i.terminate(),this.plugActionEnd(t))}.bind(this),this.global.model.save("indexeddb://model").then(function(){i.postMessage(["predictor",this.getData(),t])}.bind(this))}.bind(this),this.$options.sockets.onopen=function(){this.global.model.save(this.$tf.io.browserHTTPRequest("./api/model")).then(function(){this.$socket.sendObj({data:["predictor",this.getData(),t]})}.bind(this))}.bind(this),this.$options.sockets.onmessage=function(t){var i=JSON.parse(t.data);"onEnd"===i.data[0]?(this.plugActionPost(i.data[1]),this.$disconnect(),this.plugActionEnd(i)):"onError"===i.data[0]&&(console.error(i.data[1]),this.$disconnect(),this.plugActionEnd(i))}.bind(this),this.$options.sockets.onerror()},plugActionEvent:function(t){this.fileChart=!1,this.scatterPlot=!0,this.perClassAccuracy=!0,this.confusionMatrix=!0,this.seriesPlot=!0;var i=this.inputData.normalizationData,e=this.global.inputMatrix;null!==this.global.evaluation?e=this.global.evaluation.inputMatrix:null===this.global.evaluation&&null!==this.global.training&&(e=this.global.training.inputMatrix);var s=new Worker("worker.js");s.onmessage=function(t){if("predictorActionEvent"===t.data[0]){var i=t.data[1];this.plugActionNext(i),s.terminate()}}.bind(this),s.postMessage(["predictorActionEvent",this.getData(),e,this.global.inputShape,i])}}}}).call(this,e("c8ba"))}}]);
//# sourceMappingURL=chunk-0a711cad.2abbd176.js.map