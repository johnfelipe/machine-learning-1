(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c4f96"],{"3cb2":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("component-layout",{attrs:{component:t.component,length:t.length,loading:t.loading},on:{"update:component":function(i){t.component=i},"update:length":function(i){t.length=i},"update:loading":function(i){t.loading=i}}},[e("b-form",{staticClass:"form-toolbar-rtl",attrs:{inline:""}},[e("b-button",{attrs:{size:"badge",disabled:t.plugActionDisabled},on:{click:t.plugAction}},[e("b-icon",{staticClass:"btn-icon",attrs:{icon:"plug"}})],1),e("b-button",{attrs:{size:"badge",disabled:t.trashActionDisabled},on:{click:t.trashAction}},[e("b-icon",{staticClass:"btn-icon",attrs:{icon:"trash"}})],1),e("b-button",{attrs:{size:"badge",disabled:t.imageActionDisabled},on:{click:function(i){return t.$bvModal.show("model-view-"+t.component.index)}}},[e("b-icon",{staticClass:"btn-icon",attrs:{icon:"card-image"}})],1),e("b-button",{attrs:{size:"badge"},on:{click:t.onToggleToolbar}},[e("b-icon",{attrs:{icon:t.toggleIcon}})],1)],1),e("b-collapse",{attrs:{visible:"caret-up"===t.toggleIcon}},[e("b-form",{attrs:{inline:""}},[e("div",{staticClass:"indexInput"},[e("label",[t._v(" Input Units "),t.unitsActionDisabled?t._e():e("span",[t._v("("+t._s(t.inputSize)+")")])]),e("b-dropdown",{attrs:{text:t.unitsActionDisabled?"datasetImages":"Columns","no-flip":"",split:"","split-variant":"outline-secondary",block:"",variant:"secondary",disabled:t.editActionDisabled||t.unitsActionDisabled}},[e("b-dropdown-form",{staticStyle:{"text-align":"left"}},[t._l(t.inputUnits,(function(i){return[e("b-form",{key:i.key,attrs:{inline:""}},[e("b-form-checkbox",{attrs:{options:[!0,!1]},model:{value:i.checked,callback:function(e){t.$set(i,"checked",e)},expression:"item.checked"}}),t._v(" "+t._s(i.label)+" ")],1)]}))],2)],1)],1),e("div",{staticClass:"indexInput"},[e("label",[t._v("Input Units Normalize")]),e("b-form-select",{attrs:{options:[!0,!1],disabled:t.editActionDisabled},model:{value:t.inputUnitsNormalize,callback:function(i){t.inputUnitsNormalize=i},expression:"inputUnitsNormalize"}})],1),e("div",{staticClass:"indexInput"},[e("label",[t._v(" Output Units "),t.unitsActionDisabled?t._e():e("span",[t._v("("+t._s(t.outputSize)+")")])]),e("b-dropdown",{attrs:{text:t.unitsActionDisabled?"datasetLabels":"Columns","no-flip":"",split:"","split-variant":"outline-secondary",block:"",variant:"secondary",disabled:t.editActionDisabled||t.unitsActionDisabled}},[e("b-dropdown-form",{staticStyle:{"text-align":"left"}},[t._l(t.outputUnits,(function(i){return[e("b-form",{key:i.key,attrs:{inline:""}},[e("b-form-checkbox",{attrs:{options:[!0,!1]},model:{value:i.checked,callback:function(e){t.$set(i,"checked",e)},expression:"item.checked"}}),t._v(" "+t._s(i.label)+" ")],1)]}))],2)],1)],1),e("div",{staticClass:"indexInput"},[e("label",[t._v("Output Units Normalize")]),e("b-form-select",{attrs:{options:[!0,!1],disabled:t.editActionDisabled},model:{value:t.outputUnitsNormalize,callback:function(i){t.outputUnitsNormalize=i},expression:"outputUnitsNormalize"}})],1)]),e("b-form",{attrs:{inline:""}},[e("div",{staticClass:"indexInput"},[e("label",[t._v("Epochs")]),e("b-form-spinbutton",{attrs:{min:"1",placeholder:"--",disabled:t.editActionDisabled},model:{value:t.epochSize,callback:function(i){t.epochSize=i},expression:"epochSize"}})],1),e("div",{staticClass:"indexInput"},[e("label",[t._v("Batch Size")]),e("b-form-spinbutton",{attrs:{min:"1",placeholder:"--",disabled:t.editActionDisabled},model:{value:t.batchSize,callback:function(i){t.batchSize=i},expression:"batchSize"}})],1),e("div",{staticClass:"indexInput"},[e("label",[t._v("Validation Split")]),e("b-form-spinbutton",{attrs:{min:"0.0",max:"1.0",step:"0.01","formatter-fn":t.percentageFormatter,disabled:t.editActionDisabled},model:{value:t.validationSplit,callback:function(i){t.validationSplit=i},expression:"validationSplit"}})],1),e("div",{staticClass:"indexInput"},[e("label",[t._v("Shuffle")]),e("b-form-select",{attrs:{options:[!0,!1],disabled:t.editActionDisabled},model:{value:t.shuffle,callback:function(i){t.shuffle=i},expression:"shuffle"}})],1)]),e("b-form",{attrs:{inline:""}},[e("div",{staticClass:"indexInput"},[e("label",[t._v("Compiler Optimizer")]),e("b-form-select",{attrs:{options:t.compilerOptimizerOptions,disabled:t.editActionDisabled},model:{value:t.compilerOptimizerSelected,callback:function(i){t.compilerOptimizerSelected=i},expression:"compilerOptimizerSelected"}})],1),e("div",{staticClass:"indexInput"},[e("label",[t._v("Compiler Loss")]),e("b-form-select",{attrs:{options:t.compilerLossOptions,disabled:t.editActionDisabled},model:{value:t.compilerLossSelected,callback:function(i){t.compilerLossSelected=i},expression:"compilerLossSelected"}})],1)])],1),e("div",{staticStyle:{"margin-top":"8px"}}),e("b-modal",{attrs:{id:"model-view-"+t.component.index,title:"TS Model View",static:!0,"hide-footer":!0,size:"lg"}},[e("div",{ref:"draw"})])],1)},n=[],s=(e("4de4"),e("b0c0"),e("d3b7"),e("07ac"),e("3ca3"),e("4c53"),e("ddb0"),e("2b3d"),e("5530")),o=e("315f"),l=e("cc8f"),c=e("1157"),d=e.n(c),r=e("c8cf"),u={name:"TSModelCompiler",components:{ComponentLayout:o["a"]},mixins:[l["a"]],data:function(){var t={serializable:["shuffle","epochSize","batchSize","validationSplit","inputUnits","inputUnitsNormalize","outputUnits","outputUnitsNormalize","compilerOptimizerSelected","compilerLossSelected"],toggleIcon:"caret-up",shuffle:!0,epochSize:0,batchSize:0,validationSplit:0,inputUnits:[],inputUnitsNormalize:!1,outputUnits:[],outputUnitsNormalize:!1,compilerOptimizerSelected:null,compilerOptimizerOptions:r["tf"].train.options,compilerLossSelected:null,compilerLossOptions:r["tf"].losses.options,fileChart:!1};return this.importData(t)},computed:{unitsActionDisabled:function(){var t=0;if(t|=!0===this.loading,null!==this.inputData&&"data"in this.inputData){var i=this.inputData.data;t|="datasetImages"in i&&"datasetLabels"in i}return 1===t},editActionDisabled:function(){var t=0;return t|=!0===this.loading,t|=0===this.inputSize,t|=0===this.outputSize,1===t},trashActionDisabled:function(){return this.editActionDisabled},plugActionDisabled:function(){var t=0;return t|=!0===this.loading,this.unitsActionDisabled||null===this.inputData||(t|=this.inputUnits.filter((function(t){return!0===t.checked})).length!==this.inputSize,t|=this.outputUnits.filter((function(t){return!0===t.checked})).length!==this.outputSize),1===t},imageActionDisabled:function(){var t=0;return t|=!1===this.fileChart,1===t},inputSize:function(){var t=0;return this.inputData&&this.inputData.model&&this.inputData.model.layers&&this.inputData.model.layers.length>1&&(t=this.inputData.model.layers[0].batchInputShape[1]),t},outputSize:function(){var t=0;return this.inputData&&this.inputData.model&&this.inputData.model.layers&&this.inputData.model.layers.length>1&&(t=this.inputData.model.layers[this.inputData.model.layers.length-1].units),t},dataSize:function(){var t=0;return this.inputData&&this.inputData.data&&this.inputData.data.length&&(t=this.inputData.data[0].length),t}},watch:{inputLoading:function(t,i){!1===t&&this.trashAction()},loading:function(t,i){!1===t&&(delete this.$options.sockets.onerror,delete this.$options.sockets.onopen,delete this.$options.sockets.onmessage,delete this.$options.sockets.onclose)}},methods:{onToggleToolbar:function(){"caret-up"===this.toggleIcon?this.toggleIcon="caret-down":"caret-down"===this.toggleIcon&&(this.toggleIcon="caret-up")},trashAction:function(t){var i=this;if(d()(this.$refs["draw"]).empty(),this.fileChart=!1,this.output=null,this.loadData(this.data),this.loadData(this.component.data),this.inputData&&this.inputData.data&&this.inputData.data.length)for(var e=function(t){0===i.inputUnits.filter((function(i){return i.key===t})).length&&i.inputUnits.push({key:t,checked:!1,label:"Column "+t}),0===i.outputUnits.filter((function(i){return i.key===t})).length&&i.outputUnits.push({key:t,checked:!1,label:"Column "+t})},a=0;a<this.dataSize;a++)e(a)},plugAction:function(t){var i=this;this.loading=!0;var e=this.inputData,a=e.model,n=e.data,o=null,l=null,c=null,d=null,r={inputUnitsNormalize:this.inputUnitsNormalize,outputUnitsNormalize:this.outputUnitsNormalize};if("datasetImages"in n){c=n["datasetImages"];var u=n.spriteWidth*n.spriteHeight*n.spriteChannels,p=parseInt(c.length/u),h=this.$tf.tensor2d(c,[p,u]);o=h.reshape([p,n.spriteWidth,n.spriteHeight,n.spriteChannels])}else{c=[];for(var b=0;b<n.length;b++){for(var m=[],f=function(t){i.inputUnits.filter((function(i){return i.key===t&&!0===i.checked})).length&&m.push(parseFloat(n[b][t]))},v=0;v<this.dataSize;v++)f(v);c.push(m)}o=this.$tf.tensor2d(c)}if("datasetLabels"in n){d=n["datasetLabels"];var g=n["datasetLabelsSize"],z=parseInt(d.length/g);l=this.$tf.tensor2d(d,[z,g])}else{d=[];for(var D=0;D<n.length;D++){for(var S=[],k=function(t){i.outputUnits.filter((function(i){return i.key===t&&!0===i.checked})).length&&S.push(parseFloat(n[D][t]))},y=0;y<this.dataSize;y++)k(y);d.push(S)}l=this.$tf.tensor2d(d)}var x=null;if(this.inputUnitsNormalize){var U=o.max(),A=o.min(),O=o.sub(A).div(U.sub(A));o=O,x=U.dataSync(),r.inputMax={data:{type:x.constructor.name,data:Object.values(x)},shape:x.shape},x=A.dataSync(),r.inputMin={data:{type:x.constructor.name,data:Object.values(x)},shape:x.shape},U.dispose(),A.dispose()}if(this.outputUnitsNormalize){var w=l.max(),C=l.min(),$=l.sub(C).div(w.sub(C));l=$,x=w.dataSync(),r.outputMax={data:{type:x.constructor.name,data:Object.values(x)},shape:x.shape},x=C.dataSync(),r.outputMin={data:{type:x.constructor.name,data:Object.values(x)},shape:x.shape},w.dispose(),C.dispose()}var I=this.$tfvis.show.fitCallbacks(this.$refs["draw"],["loss","mse"],{width:700,height:200,callbacks:["onEpochEnd"]}),_=o.dataSync(),N={data:{type:_.constructor.name,data:Object.values(_)},shape:o.shape},L=l.dataSync(),j={data:{type:L.constructor.name,data:Object.values(L)},shape:l.shape};this.$options.sockets.onerror=function(){var t=new Worker("worker.js");t.onmessage=function(i){if("onEnd"===i.data[0]&&i.error)t.terminate(),this.loading=!1;else if("onEnd"===i.data[0]){var e=i.data[1];this.$tf.loadLayersModel("indexeddb://model").then(function(i){this.inputData.model=i,this.output=Object(s["a"])(Object(s["a"])({},this.inputData),{},{train:e,inputTensorJSON:N,outputTensorJSON:j,normalizationData:r}),t.terminate(),this.loading=!1}.bind(this))}else this.fileChart=!0,I[i.data[0]](i.data[1],i.data[2])}.bind(this),a.save("indexeddb://model").then(function(){t.postMessage(["compiler",this.$data,N,j]),o.dispose(),l.dispose()}.bind(this))}.bind(this),this.$options.sockets.onopen=function(){a.save(this.$tf.io.browserHTTPRequest("./api/model")).then(function(){this.$socket.sendObj({data:["compiler",this.$data,N,j]})}.bind(this))}.bind(this),this.$options.sockets.onmessage=function(t){var i=JSON.parse(t.data);if("onEnd"===i.data[0]){var e=i.data[1];this.$tf.loadLayersModel("./api/model/model.json").then(function(t){this.inputData.model=t,this.output=Object(s["a"])(Object(s["a"])({},this.inputData),{},{train:e,inputTensorJSON:N,outputTensorJSON:j,normalizationData:r}),this.$disconnect()}.bind(this))}else this.fileChart=!0,I[i.data[0]](i.data[1],i.data[2])}.bind(this),this.$options.sockets.onclose=function(){this.loading=!1}.bind(this);var T=new URL("ws://localhost:8001").hostname,M=new URL(window.location.href).hostname;T===M?this.$connect():this.$options.sockets.onerror()}}},p=u,h=e("2877"),b=Object(h["a"])(p,a,n,!1,null,"0b63e593",null);i["default"]=b.exports}}]);
//# sourceMappingURL=chunk-2d0c4f96.85158a9b.js.map