(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4865f4c0"],{"4c53":function(t,a,n){"use strict";var i=n("23e7"),e=n("857a"),o=n("af03");i({target:"String",proto:!0,forced:o("sub")},{sub:function(){return e(this,"sub","","")}})},"857a":function(t,a,n){var i=n("1d80"),e=/"/g;t.exports=function(t,a,n,o){var s=String(i(t)),r="<"+a;return""!==n&&(r+=" "+n+'="'+String(o).replace(e,"&quot;")+'"'),r+">"+s+"</"+a+">"}},af03:function(t,a,n){var i=n("d039");t.exports=function(t){return i((function(){var a=""[t]('"');return a!==a.toLowerCase()||a.split('"').length>3}))}},dd11:function(t,a,n){"use strict";n.r(a);var i=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("component-layout",{attrs:{component:t.component,length:t.length,loading:t.loading},on:{"update:component":function(a){t.component=a},"update:length":function(a){t.length=a},"update:loading":function(a){t.loading=a}}},[n("b-form",{staticClass:"form-toolbar-rtl",attrs:{inline:""}},[n("b-button",{attrs:{size:"badge",disabled:t.plugActionDisabled},on:{click:t.plugAction}},[n("b-icon",{staticClass:"btn-icon",attrs:{icon:"plug"}})],1),n("b-button",{attrs:{size:"badge",disabled:t.trashActionDisabled},on:{click:t.trashAction}},[n("b-icon",{staticClass:"btn-icon",attrs:{icon:"trash"}})],1),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"dataset-view-"+t.component.index,expression:"'dataset-view-' + component.index"}],attrs:{size:"badge",disabled:t.imageActionDisabled}},[n("b-icon",{staticClass:"btn-icon",attrs:{icon:"card-image"}})],1),n("b-button",{attrs:{size:"badge"},on:{click:t.onToggleToolbar}},[n("b-icon",{attrs:{icon:t.toggleIcon}})],1)],1),n("b-collapse",{attrs:{visible:"caret-up"===t.toggleIcon}},[n("b-form",{attrs:{inline:""}},[n("div",{staticClass:"indexInput"},[n("label",[t._v("Total Layers")]),n("b-form-spinbutton",{attrs:{min:"1",max:t.indexMax,placeholder:"--",disabled:t.editActionDisabled},model:{value:t.layerSize,callback:function(a){t.layerSize=a},expression:"layerSize"}})],1)])],1),n("div",{staticStyle:{"margin-top":"8px"}}),n("b-modal",{attrs:{id:"dataset-view-"+t.component.index,title:"Dataset View",static:!0,"hide-footer":!0,size:"lg"}},[n("center",[n("div",{ref:"draw"})])],1)],1)},e=[],o=n("e04e"),s=o["a"],r=n("2877"),d=Object(r["a"])(s,i,e,!1,null,"5fb745e3",null);a["default"]=d.exports},e04e:function(t,a,n){"use strict";(function(t){n("d81d"),n("d3b7"),n("3ca3"),n("4c53"),n("ddb0"),n("2b3d");var i=n("315f"),e=n("cc8f"),o=n("1157"),s=n.n(o);
/**
 * @license
 * Copyright 2020 Rodrigo Oshiro. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */a["a"]={name:"TSModelPredictor",components:{ComponentLayout:i["a"]},mixins:[e["a"]],data:function(){var t={serializable:["layerSize"],layerSize:0,fileChart:!1,toggleIcon:"caret-up"};return this.importData(t)},computed:{editActionDisabled:function(){var t=0;return t|=0===this.indexMax,1===t},trashActionDisabled:function(){return this.editActionDisabled},plugActionDisabled:function(){var t=0;return t|=!0===this.loading,t|=null===this.inputData||null===this.inputData.model||!(this.inputData.model instanceof Object),t|=this.layerSize>this.indexMax,1===t},imageActionDisabled:function(){var t=0;return t|=!1===this.fileChart,1===t},indexMax:function(){var t=0;return this.inputData&&this.inputData.model&&this.inputData.model.layers&&(t=this.inputData.model.layers.length),t}},watch:{inputLoading:function(t,a){!1===t&&this.trashAction()},indexMax:function(t,a){this.layerSize>t&&(this.layerSize=t)},loading:function(t,a){!1===t&&(delete this.$options.sockets.onerror,delete this.$options.sockets.onopen,delete this.$options.sockets.onmessage,delete this.$options.sockets.onclose)}},methods:{onToggleToolbar:function(){"caret-up"===this.toggleIcon?this.toggleIcon="caret-down":"caret-down"===this.toggleIcon&&(this.toggleIcon="caret-up")},trashAction:function(t){s()(this.$refs["draw"]).empty(),this.fileChart=!1,this.output=null,this.loadData(this.data),this.loadData(this.component.data)},plugActionPost:function(a){var n=this.inputData,i=n.data,e=n.inputTensorJSON,o=n.outputTensorJSON,s=n.indexLabel,r=n.normalizationData,d=null,c=null,l=t[e.data["type"]].from(e.data["data"]),u=this.$tf.tensor(l,e.shape);if(r.inputUnitsNormalize){var h=r.inputMax,p=r.inputMin,f=t[h.data["type"]].from(h.data["data"]),b=this.$tf.tensor(f,h.shape),g=t[p.data["type"]].from(p.data["data"]),m=this.$tf.tensor(g,p.shape);d=u.mul(b.sub(m)).add(m),c=d.arraySync(),b.dispose(),m.dispose()}else d=u,c=d.arraySync();var v=null,y=t[o.data["type"]].from(o.data["data"]),x=this.$tf.tensor(y,o.shape),w=null,$=t[a.data["type"]].from(a.data["data"]),D=this.$tf.tensor($,a.shape);if(r.outputUnitsNormalize){var S=r.outputMax,k=r.outputMin,z=t[S.data["type"]].from(S.data["data"]),A=this.$tf.tensor(z,S.shape),C=t[k.data["type"]].from(k.data["data"]),M=this.$tf.tensor(C,k.shape);d=x.mul(A.sub(M)).add(M),v=d.arraySync(),d=D.mul(A.sub(M)).add(M),w=d.arraySync(),A.dispose(),M.dispose()}else d=x,v=d.arraySync(),d=D,w=d.arraySync();u.dispose(),x.dispose(),D.dispose();var T=[];-1!==s&&(T=i.map((function(t){return t[s]})));for(var I=[],L=0;L<c.length;L++){for(var N=[],O=0;O<u.shape[1];O++)N.push(c[L][O]);for(var J=0;J<D.shape[1];J++)N.push(w[L][J]);-1!==s&&N.push(T[L]),I.push(N)}if(this.output=I,1===u.shape[1]&&1===x.shape[1]&&1===D.shape[1]){for(var P=[],j=[],E=0;E<c.length;E++)P.push({x:c[E][0],y:v[E][0]}),j.push({x:c[E][0],y:w[E][0]});this.$tfvis.render.scatterplot(this.$refs["draw"],{values:[P,j],series:["original","predicted"]},{width:700,height:450}),this.fileChart=!0}else this.fileChart=!1},plugAction:function(t){this.loading=!0;var a=this.inputData,n=a.model,i=a.inputTensorJSON,e=a.normalizationData;this.$options.sockets.onerror=function(){var t=new Worker("worker.js");t.onmessage=function(a){"onEnd"===a.data[0]&&a.error?(t.terminate(),this.loading=!1):"onEnd"===a.data[0]&&(this.plugActionPost(a.data[1]),t.terminate(),this.loading=!1)}.bind(this),n.save("indexeddb://model").then(function(){t.postMessage(["predictor",this.$data,i,e])}.bind(this))}.bind(this),this.$options.sockets.onopen=function(){n.save(this.$tf.io.browserHTTPRequest("./api/model")).then(function(){this.$socket.sendObj({data:["predictor",this.$data,i,e]})}.bind(this))}.bind(this),this.$options.sockets.onmessage=function(t){var a=JSON.parse(t.data);"onEnd"===a.data[0]&&(this.plugActionPost(a.data[1]),this.$disconnect())}.bind(this),this.$options.sockets.onclose=function(){this.loading=!1}.bind(this);var o=new URL("ws://localhost:8001").hostname,s=new URL(window.location.href).hostname;o===s?this.$connect():this.$options.sockets.onerror()}}}}).call(this,n("c8ba"))}}]);
//# sourceMappingURL=chunk-4865f4c0.506147ae.js.map